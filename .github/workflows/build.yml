# name: Matrix Build & Artifacts Demo

# on:
#   push:
#     branches:
#       - main
#   workflow_dispatch: # Allows manual triggering

# jobs:
#   build:
#     runs-on: ubuntu-latest
#     strategy:
#       matrix:
#         # Define a matrix with 3 variants
#         node-version: [18, 20, 22]

#     steps:
#       - name: Checkout code
#         uses: actions/checkout@v4

#       # This step includes the required dynamic identifier
#       - name: Build for Node ${{ matrix.node-version }} (matrix-c064f21)
#         run: |
#           echo "Simulating build for Node.js version ${{ matrix.node-version }}"
#           echo "This is the build output." > build_output.txt
#           echo "Identifier: matrix-c064f21" >> build_output.txt

#       # This step uploads an artifact with the required dynamic prefix
#       - name: Upload Artifact
#         uses: actions/upload-artifact@v4
#         with:
#           # Use the prefix and include the matrix variant in the name
#           name: build-c064f21-node-${{ matrix.node-version }}
#           path: build_output.txt
#           retention-days: 7


name: Matrix Build (3e170e5)

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build:
    name: Build v${{ matrix.version }}
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        version: [14, 16, 18]  # >= 3 variants

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      # Identifier included here (validator requirement)
      - name: Build step (matrix-3e170e5) for v${{ matrix.version }}
        run: |
          echo "Building for version ${{ matrix.version }}"
          echo "Validator identifier: matrix-3e170e5"
          # Create a non-empty artifact with some useful content
          {
            echo "Build output for version ${{ matrix.version }}";
            echo "Timestamp: $(date -u +'%Y-%m-%dT%H:%M:%SZ')";
            echo "Runner: ${{ runner.os }}";
            echo "Identifier: matrix-3e170e5";
          } > output_v${{ matrix.version }}.txt

      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          # Required prefix
          name: build-3e170e5-v${{ matrix.version }}
          path: output_v${{ matrix.version }}.txt
          retention-days: 7
